#!/usr/bin/env python

import icedbProgSetup  # noqa: F401
import argparse
from gencode.data.gencodeGenes import GencodeGenes
from gencode_icedb.rsl.gencodeIntronEvid import GencodeIntronEvidSet


verbose = False


def parseArgs():
    desc = """Compute per-transcript support levels and annotations from RNA-Seq
    evidence."""
    parser = argparse.ArgumentParser(description=desc)
    parser.add_argument('--verbose', action="store_true", default=False,
                        help="write verbose output")
    parser.add_argument('gencodeGenePred',
                        help="gencode genePred ")
    parser.add_argument('gencodeAttrTsv',
                        help="GENCODE attributes")
    parser.add_argument('spliceJunctionEvidTsv',
                        help="length of reads that will be mapped; used to calculate splice junction overhang")
    opts = parser.parse_args()
    global verbose
    verbose = opts.verbose
    return opts


class GencodeIntronSupport(object):
    def __init__(self, gencodeGenePred, gencodeAttrTsv, spliceJunctionEvidTsv):
        self.intronEvid = GencodeIntronEvidSet(spliceJunctionEvidTsv)
        self.gencode = GencodeGenes.loadFromFiles(gencodeGenePred, gencodeAttrTsv)

    def __calculateIntronSupportLevel(self, evid):
        pass

    def calculateSupportLevel(evid):
        pass

    def scoreTranscriptLocus(transLocus):
        pass


opts = parseArgs()
gis = GencodeIntronSupport(opts.gencodeGenePred, opts.gencodeAttrTsv, opts.spliceJunctionEvidTsv)
