#!/bin/bash 

source ~/.bashenvrc
export LD_LIBRARY_PATH=lib
set -beEu -o pipefail
prog=$(dirname $(which $0))/starSpliceJunctionMap

ulimit -a >&2

# add atomic create
args=( "$@" )
nargs=${#args[@]}
sjout=${args[nargs-1]}
sjoutTmp=${sjout}.$(hostname).$$.tmp
args[nargs-1]=${sjoutTmp}

mkdir -p $(dirname $sjout)

eval $prog "${args[@]}"

mv -f ${sjoutTmp} ${sjout}
