#!/usr/bin/env python3
import icedbProgSetup  # noqa: F401
import argparse
from gencode_icedb.tsl.genbankProblemCasesDb import GenbankProblemCaseDbTable
from pycbio.tsv.tabFile import TabFile
from pycbio.hgdata.hgLite import sqliteConnect


def parseArgs():
    desc = """Load problem case tab file generate gbffGetProblemCases by
    into a sqlite3 databases. """
    parser = argparse.ArgumentParser(description=desc)
    parser.add_argument('problemTabFile',
                        help="""tab file with problem accessions and reasons""")
    parser.add_argument('sqliteDb',
                        help="""database to load problems into""")
    parser.add_argument('table',
                        help="""table to load problems into""")
    return parser.parse_args()


def genbankProblemCasesLoad(opts):
    "main function"
    rows = TabFile(opts.problemTabFile)
    conn = sqliteConnect(opts.sqliteDb, create=True)
    problemTable = GenbankProblemCaseDbTable(conn, opts.table, create=True)
    problemTable.loads(rows)
    conn.close()


genbankProblemCasesLoad(parseArgs())
